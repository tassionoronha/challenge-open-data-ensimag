<html>
<head>
  <meta charset="utf-8">
  <title>Unit Test's</title>
  <link href="https://cdn.rawgit.com/mochajs/mocha/2.2.5/mocha.css" rel="stylesheet" />
</head>
<body>
  <div id="mocha"></div>
  <canvas id="multiradar" hidden></canvas>

  <script src="https://cdn.rawgit.com/jquery/jquery/2.1.4/dist/jquery.min.js"></script>
  <script src="https://cdn.rawgit.com/Automattic/expect.js/0.3.1/index.js"></script>
  <script src="https://cdn.rawgit.com/mochajs/mocha/2.2.5/mocha.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
  <script src="node_modules/expect.js/index.js"></script>
  <script type="text/javascript" src="data.json"></script>
  <script type="text/javascript" src="dataMonth.json"></script>
  <script type="text/javascript" src="monthlyDatas2007.json"></script>
  <script type="text/javascript" src="dailyDatas2007.json"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment-with-locales.min.js"></script>
  <script type="text/javascript" src="Functions.js"></script>
  <script src="./classes/Factory.js" type="module"></script>
  <script>mocha.setup('bdd')</script>
  <script type='module'>
  import Factory from './classes/Factory.js';

  describe('Tests of Factory', function() {
    var canvas = document.getElementById('multiradar').getContext('2d');

    var argsChart = {
      year:2007,
      month: 1,
      canvas:canvas,
      station: 0,
      type: 0,
      state: []
    };

    var preChart = new Factory('radar', argsChart);
    var chart = new Factory('radar', argsChart).chart.generateChart();
    describe('Factory.js', function() {

        var factory = new Factory('radar', argsChart);
        it('Test getChart', function() {
          expect(preChart.getChart()).to.be.a('object');
        });
        it('Check year', function() {
          expect(chart.year).to.be(2007);
        });
        it('Check dataset', function() {
          expect(chart.datasets).to.be.a('array');
        });
        it('Check colors', function() {
          expect(chart.colors).to.have.length(12);
        });
        it('Exists dataReader', function() {
          expect(chart.dataReader).to.be.a('object');
        });
        it('Exists graph type', function() {
          expect(chart.graph).not.to.equal(null);
        });
        it('Exists chart object', function() {
          expect(chart.chart).to.have.property('chart')
          expect(chart.chart).to.have.property('chartArea')
          expect(chart.chart).to.have.property('config')
          expect(chart.chart).to.have.property('scale')
        });
        it('Validate args', function() {
          expect(factory.validateArgs('radar', argsChart)).not.to.equal(false);
        });
    });
    describe('MultiGraph.js', function() {
        it('Validate destroyChart', function() {
          var testObj = chart;
          testObj = testObj.destroyChart();
          for (var i = 0; i < 6; i++) {
            expect(testObj.state[i]).to.be(null);
          }
          expect(testObj.dataReader.faults).to.be.empty();
        });
        it('getOptions', function() {
          var testObj = chart;
          expect(testObj.getOptions('line')).to.be.a('object');
          expect(testObj.getOptions('line')).to.have.property('scales');
          expect(testObj.getOptions('radar')).to.be.a('object');
          expect(testObj.getOptions('radar')).to.have.property('scale');
        });

    });
  });

    mocha.checkLeaks();
    mocha.globals(['jQuery']);
    mocha.run();
  </script>
</body>
</html>
